name: ðŸš€ GitHub Pages - Branch HML

on:
  push:
    branches: [ hml ]
  workflow_dispatch:

permissions:
  contents: read
  pages: write
  id-token: write

concurrency:
  group: "pages"
  cancel-in-progress: false

jobs:
  deploy:
    environment:
      name: github-pages
      url: ${{ steps.deployment.outputs.page_url }}
    runs-on: ubuntu-latest
    steps:
      - name: ðŸ“¥ Checkout
        uses: actions/checkout@v4
        with:
          fetch-depth: 0
          
      - name: ðŸ”§ Setup Pages
        uses: actions/configure-pages@v4
        
      - name: ðŸ“¦ Build
        run: |
          echo "ðŸ”¨ Preparando arquivos para GitHub Pages..."
          
          # Cria diretÃ³rio de build
          mkdir -p dist
          
          # Copia arquivos principais
          cp *.html dist/
          cp *.js dist/
          cp *.md dist/
          
          # Cria arquivo de configuraÃ§Ã£o
          cat > dist/README.md << 'EOF'
          # ðŸŒ GitHub Pages - Branch HML
          
          ## ðŸ“‹ Sobre
          Esta Ã© a versÃ£o de homologaÃ§Ã£o do sistema de captura de parÃ¢metros para GTM.
          
          ## ðŸ”§ Arquivos Principais
          - `versao_atual_GTM.js` - Script principal corrigido
          - `teste_validacao.html` - Ferramenta de teste
          - `CORREÃ‡Ã•ES_IMPLEMENTADAS.md` - DocumentaÃ§Ã£o das correÃ§Ãµes
          
          ## ðŸ§ª Como Testar
          1. Abra o DevTools (F12)
          2. Verifique as mensagens "Trinks Debug:" no console
          3. Teste a interceptaÃ§Ã£o de links
          
          ## ðŸ“Š Status
          - **Branch**: hml
          - **Ãšltimo Deploy**: $(date)
          - **Status**: âœ… Funcionando
          EOF
          
          echo "âœ… Build concluÃ­do!"
          
      - name: ðŸš€ Deploy
        id: deployment
        uses: actions/deploy-pages@v4
